<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>TIMELESS Ranch Group — Demo</title>
<meta name="description" content="Timeless Ranch demo gallery" />
<style>
  /* Basic reset and layout */
  :root{ --bg:#0b0f13; --panel:#0f1720; --muted:#9aa3ad; --accent:#d8b04a; --card:#0d1318; color-scheme: dark; }
  body{ margin:0; font-family: Inter, system-ui, Arial; background: linear-gradient(180deg,#071019 0%, #0b1220 100%); color:#e6eef3; }
  header{ display:flex; align-items:center; justify-content:space-between; padding:18px 28px; background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02)); }
  .brand{ display:flex; gap:12px; align-items:center; }
  .brand img{ width:48px; height:48px; object-fit:contain; border-radius:6px; }
  .brand h1{ margin:0; font-size:18px; letter-spacing:0.6px; color:#fff; }
  nav.filters{ display:flex; gap:8px; align-items:center; }
  .btn{ background:transparent; border:1px solid rgba(255,255,255,0.06); padding:8px 12px; border-radius:8px; cursor:pointer; color:var(--muted); }
  .btn.active{ background:var(--accent); color:#071019; border-color:transparent; font-weight:600; box-shadow:0 6px 18px rgba(0,0,0,0.5); }

  /* Main */
  main{ padding:28px; max-width:1200px; margin:0 auto; }
  .gallery{ display:grid; grid-template-columns: repeat(auto-fill,minmax(240px,1fr)); gap:16px; margin-top:18px; }
  .card{ background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.03)); border-radius:10px; overflow:hidden; border:1px solid rgba(255,255,255,0.03); min-height:160px; display:flex; flex-direction:column; }
  .card .thumb{ display:block; width:100%; height:160px; object-fit:cover; background:#07121a; cursor:pointer; }
  .card .meta{ padding:10px; display:flex; justify-content:space-between; align-items:center; }
  .meta .title{ font-size:13px; color:#fff; }
  .meta .cat{ font-size:12px; color:var(--muted); }

  /* Lightbox */
  .lightbox{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(4,6,8,0.85); z-index:9999; }
  .lightbox img{ max-width:92%; max-height:86%; box-shadow:0 20px 60px rgba(0,0,0,0.7); border-radius:6px; }
  .lightbox .close{ position:absolute; top:20px; right:28px; color:#fff; font-size:18px; background:rgba(255,255,255,0.04); padding:8px 10px; border-radius:6px; cursor:pointer; }
  .hint{ color:var(--muted); margin-top:8px; font-size:13px; }

  footer{ text-align:center; padding:28px; color:var(--muted); }
  @media (max-width:600px){ .card .thumb{ height:140px; } header{ padding:12px } main{ padding:14px } }
</style>
</head>
<body>

<header>
  <div class="brand">
    <img src="assets/logo.jpg" alt="logo" onerror="this.style.display='none'"/>
    <div>
      <h1>TIMELESS Ranch Group</h1>
      <div style="color:var(--muted); font-size:13px;">Agriculture · Real Estate · Transport</div>
    </div>
  </div>

  <nav class="filters" aria-label="Gallery filters">
    <button class="btn active" data-filter="all">All</button>
    <button class="btn" data-filter="agriculture">Agriculture</button>
    <button class="btn" data-filter="realestate">Real Estate</button>
    <button class="btn" data-filter="transport">Transport</button>
    <button class="btn" data-filter="bundles">Bundles</button>
  </nav>
</header>

<main>
  <div style="display:flex; justify-content:space-between; align-items:center;">
    <div>
      <h2 style="margin:0 0 6px 0;">Gallery</h2>
      <div class="hint">Click an image to view it larger. Filters are above.</div>
    </div>
  </div>

  <div class="gallery" id="gallery"></div>
</main>

<!-- Lightbox -->
<div class="lightbox" id="lightbox" role="dialog" aria-hidden="true">
  <button class="close" id="lbClose">✕</button>
  <img id="lbImage" alt="enlarged image">
</div>

<footer>© TIMELESS Ranch Group — Demo site. Edit the images in <code>/assets</code>.</footer>

<script>
/*
  GALLERY DATA:
  If any name below does not match exactly your assets folder,
  update it (for example change agri-2.jpg to agri-2.jpeg).
  The fallback code below will still try other extensions if needed.
*/
const images = [
  // Agriculture
  {file:'assets/agri-1.jpg', title:'Market produce', cat:'agriculture'},
  {file:'assets/agri-2.jpg', title:'Veg stall', cat:'agriculture'},
  {file:'assets/agri-3.jpg', title:'Produce crates', cat:'agriculture'},
  {file:'assets/agri-4.jpg', title:'Field', cat:'agriculture'},
  {file:'assets/agri-5.jpg', title:'Roots', cat:'agriculture'},
  {file:'assets/agri-6.jpg', title:'Fresh harvest', cat:'agriculture'},
  {file:'assets/agri-7.jpg', title:'Palm', cat:'agriculture'},
  {file:'assets/agri-8.jpg', title:'Palm 2', cat:'agriculture'},
  {file:'assets/agri-9.jpg', title:'Harvest', cat:'agriculture'},
  {file:'assets/agri-10.jpg', title:'Poultry', cat:'agriculture'},
  {file:'assets/agri-11.jpg', title:'Eggs', cat:'agriculture'},
  {file:'assets/agri-12.jpg', title:'Agri 12', cat:'agriculture'},

  // Bundles / marketing image
  {file:'assets/bundle-1.jpg', title:'Bundle Offers', cat:'bundles'},

  // Real estate
  {file:'assets/estate-1.jpg', title:'Model house 1', cat:'realestate'},
  {file:'assets/estate-2.jpg', title:'Model house 2', cat:'realestate'},
  {file:'assets/estate-3.jpg', title:'Estate land', cat:'realestate'},
  {file:'assets/estate-4.jpg', title:'Estate 4', cat:'realestate'},
  {file:'assets/estate-5.jpg', title:'Estate 5', cat:'realestate'},
  {file:'assets/estate-6.jpg', title:'Estate 6', cat:'realestate'},
  {file:'assets/estate-7.jpg', title:'Estate 7', cat:'realestate'},
  {file:'assets/estate-8.jpg', title:'Estate 8', cat:'realestate'},
  {file:'assets/estate-9.jpg', title:'Estate 9', cat:'realestate'},
  {file:'assets/estate-10.jpg', title:'Estate 10', cat:'realestate'},

  // Transport
  {file:'assets/transport-1.jpg', title:'Delivery truck', cat:'transport'},
  {file:'assets/transport-2.jpg', title:'Transport 2', cat:'transport'},
  {file:'assets/transport-3.jpg', title:'Transport 3', cat:'transport'},
  {file:'assets/transport-4.jpg', title:'Transport bike', cat:'transport'},
  {file:'assets/transport-5.jpg', title:'Transport 5', cat:'transport'},
  {file:'assets/transport-6.jpg', title:'Transport 6', cat:'transport'},
  {file:'assets/transport-7.jpg', title:'Transport 7', cat:'transport'},
  {file:'assets/transport-8.jpg', title:'Transport 8', cat:'transport'},

  // Hero and logo (kept in list so lightbox can show them if needed)
  {file:'assets/hero.jpg', title:'Hero image', cat:'bundles'},
  {file:'assets/logo.jpg', title:'Logo', cat:'bundles'}
];

/* Build gallery markup */
const gallery = document.getElementById('gallery');

function makeCard(item){
  const div = document.createElement('div');
  div.className = 'card';
  div.dataset.cat = item.cat || 'all';

  const img = document.createElement('img');
  img.className = 'thumb';
  img.alt = item.title || '';
  img.loading = 'lazy';
  img.dataset.src = item.file;   // keep original reference
  img.src = item.file;           // initial attempt
  // install fallback onerror (dynamically)
  img.addEventListener('error', async function onerr(){
    // if this error fired, try alternate extensions (jpg, jpeg, png, webp)
    const exts = ['jpg','jpeg','png','webp'];
    const base = item.file.replace(/\.\w+(\?.*)?$/,'');
    for (const e of exts){
      const cand = base + '.' + e;
      if (cand === img.src) continue;
      // try HEAD (best-effort)
      try {
        const res = await fetch(cand, { method:'HEAD', cache:'no-store' });
        if (res.ok){
          img.removeEventListener('error', onerr);
          img.src = cand;
          return;
        }
      } catch(err){
        // HEAD may be blocked cross-origin — try setting src anyway
      }
      // set src and let browser try to load (onerror may re-fire)
      img.src = cand;
      // give it a moment — if it fails the error will re-fire and loop continues
      return;
    }
    // no alternatives, remove handler
    img.removeEventListener('error', onerr);
  });

  div.appendChild(img);

  const meta = document.createElement('div');
  meta.className = 'meta';
  meta.innerHTML = `<div class="title">${item.title||''}</div><div class="cat">${item.cat||''}</div>`;
  div.appendChild(meta);

  // click to open lightbox
  img.addEventListener('click', ()=> openLightbox(img.src, item.title));
  return div;
}

function renderGallery(list){
  gallery.innerHTML = '';
  for (const it of list){
    gallery.appendChild(makeCard(it));
  }
}

/* Filters */
document.querySelectorAll('.filters .btn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    document.querySelectorAll('.filters .btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    const f = btn.dataset.filter;
    if (f === 'all'){
      renderGallery(images);
    } else {
      renderGallery(images.filter(i=>i.cat === f));
    }
    // re-run lazy/fallback install (images already created attach error handler)
  });
});

/* Lightbox code */
const lightbox = document.getElementById('lightbox');
const lbImage = document.getElementById('lbImage');
const lbClose = document.getElementById('lbClose');

function openLightbox(src, title){
  lbImage.src = src;
  lbImage.alt = title || '';
  lightbox.style.display = 'flex';
  lightbox.setAttribute('aria-hidden','false');
}
function closeLightbox(){
  lightbox.style.display = 'none';
  lightbox.setAttribute('aria-hidden','true');
  lbImage.src = '';
}
lbClose.addEventListener('click', closeLightbox);
lightbox.addEventListener('click', (e)=>{ if (e.target === lightbox) closeLightbox(); });

/* Initialize */
renderGallery(images);

/* Accessibility: keyboard close */
document.addEventListener('keydown', (e)=>{
  if (e.key === 'Escape') closeLightbox();
});

/* Observe DOM for newly added images (if your site scripts later add images) */
const mo = new MutationObserver(muts=>{
  muts.forEach(m=>{
    m.addedNodes.forEach(node=>{
      if (node.nodeType !== 1) return;
      if (node.tagName === 'IMG' && node.classList.contains('thumb')) {
        // ensure click works
        node.addEventListener('click', ()=> openLightbox(node.src, node.alt||''));
      }
    });
  });
});
mo.observe(document.body, { childList:true, subtree:true });

/* A final defensive fallback: try to fix backgrounds and any element with data-src */
async function finalSweep(){
  // data-src elements
  document.querySelectorAll('[data-src]').forEach(el=>{
    const src = el.dataset.src;
    if (src && (!el.src || el.src.endsWith('placeholder'))){
      el.src = src;
    }
  });
  // inline background images (try HEAD to see if exists)
  document.querySelectorAll('*').forEach(async el=>{
    const bg = getComputedStyle(el).backgroundImage;
    if (!bg || bg === 'none') return;
    const m = bg.match(/url\(["']?(.+?)["']?\)/);
    if (!m) return;
    const full = m[1];
    const base = full.replace(/\.\w+(\?.*)?$/,'');
    const exts = ['jpg','jpeg','png','webp'];
    for (const e of exts){
      const cand = base + '.' + e;
      try {
        const r = await fetch(cand, { method:'HEAD', cache:'no-store' });
        if (r.ok){
          el.style.backgroundImage = `url("${cand}")`;
          break;
        }
      } catch(e){}
    }
  });
}
setTimeout(finalSweep, 1200); // run after page scripts
</script>
</body>
</html>
